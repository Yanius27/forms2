!function(){"use strict";class e{constructor(){this._element,this.createElements()}createElements(){const e=document.createElement("div");e.classList.add("container");const t=document.createElement("span");t.textContent="Товары";const s=document.createElement("button");s.classList.add("addIcon"),s.textContent="+";const n=document.createElement("div");n.classList.add("header"),n.appendChild(t),n.appendChild(s),e.appendChild(n),this.containerMask=document.createElement("div"),this.containerMask.classList.add("container_mask"),document.body.appendChild(this.containerMask),this._element=e}listener(e){this._element.querySelector(".addIcon").addEventListener("click",(()=>{this.containerMask.classList.add("mask_active"),e.classList.remove("popOver_inactive"),e.classList.add("popOver_active")}))}get element(){return this._element}}class t{constructor(){this._element,this.createTable()}createTable(){const e=document.createElement("table");e.classList.add("table");const t=document.createElement("thead");t.classList.add("tHead");const s=document.createElement("tbody");s.classList.add("tBody");const n=document.createElement("tr"),a=document.createElement("th");a.textContent="Название";const i=document.createElement("th");i.textContent="Стоимость";const d=document.createElement("th");d.textContent="Действия",n.appendChild(a),n.appendChild(i),n.appendChild(d),t.appendChild(n),e.appendChild(t),e.appendChild(s),this._element=e}createProduct(e,t,s){const n=document.createElement("tr");n.classList.add("product"),n.setAttribute("id",s);const a=document.createElement("td");a.textContent=e;const i=document.createElement("td");i.textContent=t;const d=document.createElement("td");d.classList.add("actionTd");const c=document.createElement("div");c.classList.add("productIcon"),c.classList.add("editIcon");const o=document.createElement("div");o.classList.add("productIcon"),o.classList.add("deleteIcon"),d.appendChild(c),d.appendChild(o),n.appendChild(a),n.appendChild(i),n.appendChild(d),document.querySelector(".tBody").appendChild(n)}get element(){return this._element}}class s{constructor(){this._element,this.createElement()}createElement(){const e=document.createElement("div");e.classList.add("popOver_inactive");const t=document.createElement("form");t.classList.add("popOver_form"),t.setAttribute("novalidate","");const s=document.createElement("div");s.classList.add("inputsContainer");const n=document.createElement("label");n.textContent="Название",n.classList.add("nameLabel"),n.setAttribute("for","productNameInput");const a=document.createElement("input");a.setAttribute("type","text"),a.setAttribute("name","productName"),a.setAttribute("id","productNameInput"),a.setAttribute("required","");const i=document.createElement("label");i.textContent="Стоимость",i.classList.add("priceLabel"),i.setAttribute("for","productPriceInput");const d=document.createElement("input");d.setAttribute("name","productPrice"),d.setAttribute("id","productPriceInput"),d.setAttribute("pattern","^[1-9][0-9]+$"),d.setAttribute("required",""),s.appendChild(n),s.appendChild(a),s.appendChild(i),s.appendChild(d);const c=document.createElement("div");c.classList.add("buttonsContainer");const o=document.createElement("button");o.textContent="Сохранить",o.classList.add("saveButton"),o.classList.add("btn"),o.setAttribute("type","submit");const r=document.createElement("button");r.textContent="Отмена",r.classList.add("abortButton"),r.classList.add("btn"),r.setAttribute("type","button"),c.appendChild(o),c.appendChild(r),t.appendChild(s),t.appendChild(c),e.appendChild(t),this._element=e}get element(){return this._element}}class n{constructor(){this.createElement()}createElement(){const e=document.createElement("div");e.classList.add("messageContainer_inactive");const t=document.createElement("span");t.classList.add("messageSpan"),t.textContent="Вы уверены, что хотите удалить этот товар?";const s=document.createElement("div");s.classList.add("buttonsContainer");const n=document.createElement("button");n.classList.add("btn"),n.classList.add("ok"),n.textContent="Ok";const a=document.createElement("button");a.classList.add("btn"),a.classList.add("cancel"),a.textContent="Cancel",s.appendChild(n),s.appendChild(a),e.appendChild(t),e.appendChild(s),this._element=e}get element(){return this._element}}new class{constructor(){this.container=new e,this.table=new t,this.popOver=new s,this.deleteMessage=new n,this.storage=localStorage,this.errors={productName:{valueMissing:"Введите наименование товара"},productPrice:{valueMissing:"Введите стоимость товара",patternMismatch:"Введите положительное натуральное число"}},this.init()}init(){this.drawElements(),this.products=this.getStorage()?this.getStorage():[],this.products.length&&this.drawProducts()}drawElements(){this.container.element.appendChild(this.table.element),document.body.appendChild(this.container.element),document.querySelector(".container").appendChild(this.popOver.element),this.form=Array.from(document.forms[0]),this.container.listener(this.popOver.element),this.formListeners(),document.querySelector(".container").appendChild(this.deleteMessage.element)}editAndRemoveButtonsListeners(){this.productsIcons=Array.from(this.table.element.querySelectorAll(".productIcon")),this.productsIcons.length&&this.productsIcons.forEach((e=>{e.addEventListener("click",(e=>{this.editOrDeleteProduct.bind(this)(e.target)}))}))}formListeners(){const e=document.querySelector(".popOver_form");e.addEventListener("submit",(t=>{t.preventDefault();const{elements:s}=e;if([...s].some((e=>(e.validity.valueMissing||e.validity.patternMismatch||e.setCustomValidity(""),Object.keys(ValidityState.prototype).some((t=>{if(e.name&&"valid"!==t&&"customError"!==t)return e.validity[t]?(e.setCustomValidity(this.errors[e.name][t]),!0):void 0}))))))return console.dir(s),void e.reportValidity();this.addOrEditProduct.bind(this)(t.type)})),e.querySelector(".abortButton").addEventListener("click",this.addOrEditProduct.bind(this))}deleteMessageListener(e){Array.from(this.deleteMessage.element.querySelectorAll(".btn")).forEach((t=>{t.addEventListener("click",(()=>{t.classList.contains("ok")&&(this.products=this.products.filter((t=>t.id!==e.id)),this.setStorage(),this.drawProducts()),this.deleteMessage.element.classList.remove("messageContainer_active"),this.deleteMessage.element.classList.add("messageContainer_inactive")}))}))}addOrEditProduct(e){const t=Array.from(document.querySelectorAll(".productIcon")).find((e=>e.classList.contains("editIcon_active")));let s;if(t&&(s=t.parentNode.parentNode),t&&"click"===e)s.childNodes[2].childNodes[0].classList.remove("editIcon_active");else if(t&&"submit"===e){const e=this.products.find((e=>e.id===s.id));e.name=this.form[0].value,e.price=this.form[1].value,s.childNodes[2].childNodes[0].classList.remove("editIcon_active"),this.setStorage(),this.drawProducts()}else if(!t&&"submit"===e){const e=`${Math.floor(1e4*Math.random())}${Math.floor(1e4*Math.random())}${Math.floor(1e4*Math.random())}`;this.products.push({name:this.form[0].value,price:this.form[1].value,id:e}),this.setStorage(),this.drawProducts()}this.container.containerMask.classList.remove("mask_active"),this.popOver.element.classList.remove("popOver_active"),this.popOver.element.classList.add("popOver_inactive"),this.form.forEach((e=>e.value=""))}drawProducts(){document.querySelector(".tBody").innerHTML="",this.products.forEach((e=>{this.table.createProduct(e.name,e.price,e.id)})),this.editAndRemoveButtonsListeners()}setStorage(){this.storage.setItem("products",JSON.stringify(this.products))}getStorage(){return JSON.parse(this.storage.getItem("products"))}editOrDeleteProduct(e){e.classList.contains("editIcon")?(e.classList.add("editIcon_active"),this.container.containerMask.classList.add("mask_active"),this.popOver.element.classList.remove("popOver_inactive"),this.popOver.element.classList.add("popOver_active"),document.forms[0][0].value=e.parentNode.parentNode.childNodes[0].textContent,document.forms[0][1].value=e.parentNode.parentNode.childNodes[1].textContent):(this.deleteMessage.element.classList.remove("messageContainer_inactive"),this.deleteMessage.element.classList.add("messageContainer_active"),this.deleteMessageListener(e.parentNode.parentNode))}}}();
//# sourceMappingURL=main.js.map